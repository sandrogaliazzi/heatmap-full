import knex from "../mkDatabase/index.js";
import fs from "fs";

const entrada = `
IZABEL SOARES DE AZEREDO,08/20/2025
MARCIELE TAIS DIAS,08/10/2025
VITOR HUGO FERNANDES LOPES,07/10/2025
FABRICIO DOS SANTOS,07/25/2025
SUELEN DE MEIRA LIMA,07/10/2025
RONALDO SANTIAGO,07/10/2025
ADILES DE OLIVEIRA SOARES,07/10/2025
DILMA DA SILVA DE OLIVEIRA,07/20/2025
MARCOS ANTUNES DA SILVA,07/10/2025
CESAR JULIANO TELLES REGES,07/25/2025
JOICE GRASSI MACIEL,07/5/2025
CARLOS ALBERTO DOS SANTOS SCHAEFFER,07/28/2025
HARRY RITTER,07/10/2025
NELSON SOARES DA SILVA,07/5/2025
JONATAS LEMOS PIRES,07/28/2025
ALISON DA SILVA ROSA,07/28/2025
DALIRIO AMORIN,07/15/2025
GUILHERME NERI DE OLIVEIRA,07/28/2025
CARMEM DENIZE BORTH,07/28/2025
ANTONIO MATHEUS DIAS MATOS,07/15/2025
IMUNIZADORA IGREJINHA LTDA,07/25/2025
SINARA TEIXEIRA DA SILVA,07/10/2025
JOSE LUIZ ALVES DA SILVA,07/28/2025
RAFAELA SOUZA OLIVEIRA,07/20/2025
PATRICIA SOUZA,07/25/2025
OSVALDO BERNARDI,07/28/2025
EVANDRO FRANK,07/10/2025
JANAINA JESSICA DA SILVA,07/20/2025
CRISTIANO DOS SANTOS,07/10/2025
NATAN ROBERTO PATZLAFF,07/15/2025
GLEISY MAIKIELY ARDENGHI VIEIRA,07/10/2025
MARIA REGINA DA SILVEIRA,07/29/2025
DENISE REGINA DE CAMARGO PEREIRA,07/10/2025
MARCIA SANDER DA SILVA,07/10/2025
JAQUELINE DA SILVA,07/10/2025
GUSTAVO AZEVEDO DA SILVA,07/15/2025
JULIANA GONZAGA,07/28/2025
TAIS RIBEIRO DA SILVA,06/25/2025
ROSELAINE MARIA BERTONCELLO,07/25/2025
RAQUEL MARQUES DA SILVA,07/10/2025
INES MARGARETE NUNES DA ROSA,07/12/2025
REGINA IARA BRAGA DE ROZADO,07/10/2025
GELSON AGUIAR LUCAS DOS SANTOS,07/10/2025
LUISA CAROLINE BEHLING,07/10/2025
ANA PAULA SOARES DA SILVA,07/25/2025
ADRIANA FREITAG DOS SANTOS SPARRENBERGER,07/28/2025
MARCIO DOS SANTOS,07/20/2025
PRYSCILLA NUNES,07/10/2025
VERONI APARECIDA SILVA DOS SANTOS,07/10/2025
BRUNA TAINA LICTENFELS,07/28/2025
ELISANGELA VERENICE SCHMITT,07/26/2025
LUIS GUSTAVO DA SILVA,07/25/2025
RODRIGO LUIZ LAZARIN,07/10/2025
JEISEBEL DA SILVA,07/10/2025
WILLIAM DE MELLO BARBOSA,07/10/2025
TACIO KOSARCZUK DORNELES,07/10/2025
WELLINGHTON IAGARO DA SILVA,07/15/2025
CAROLYN GABRIELA DOS SANTOS,07/15/2025
CAROLYN GABRIELA DOS SANTOS,07/7/2025
ADIELSON DE PAULA DIAS,07/25/2025
VILMAR DE AVILA VARGAS,07/28/2025
JOSIMARI MORAES,07/10/2025
JOCENIRA DE MATTOS PONS,07/10/2025
EVANIR LUIS HAUBERT,07/10/2025
ANTUNES & GONCHOROSKI LTDA,08/23/2025
BRENDA GIULIA FERRAZ,07/10/2025
AMANDA DA CONCEICAO SILVA,07/15/2025
MACIEL FABIANO LOTH,07/15/2025
MARIA DIRLEI SANTOS DA SILVA,07/23/2025
LETICIA DE OLIVEIRA BATISTA,07/28/2025
IGOR DUARTE RIBAS,07/10/2025
UBIRATAN LUCIANO SCHUCH,07/10/2025
CHRISTIAN HOFFMEISTER DA SILVEIRA,07/10/2025
MARILENA DE FATIMA DA SILVA,07/10/2025
JONES JOES MAUS,07/10/2025
NOBRE ATACADO PORTA ABERTA LTDA,07/12/2025
FABIANE CRISTINA DIAS,07/20/2025
FABIANE CRISTINA DIAS,06/20/2025
F.A. MARMORES E GRANITOS LTDA,07/15/2025
ELENIR NOGUEIRA AIRES,07/5/2025
LUIS ODILON ROSADO DE ASSUNCAO,07/10/2025
NOEMI MARIA DA ROSA,07/28/2025
LETICIA SANTOS DA COSTA,07/10/2025
KEILA LINE DE SOUZA,07/25/2025
FRANCIELE KIEWEL,07/28/2025
SIDINEI TADEU PEREIRA DOS SANTOS,07/10/2025
DOUGLAS EDUARDO CORREA,07/10/2025
LEDIANE REIS MULLER,07/25/2025
LEANDRO DOS SANTOS,07/10/2025
SANDRA DE FATIMA MARQUES DA SILVA,07/10/2025
TATIANI RABELO PRIMAZ,07/28/2025
IRACI FRUTUOSO DOS SANTOS LEITE,07/25/2025
AURECI AURELIO MARTINI,07/10/2025
MARGARETE TERESINHA LEAL RODRIGUES,07/15/2025
PEDRO AMARO RAMIRES DA SILVA,07/10/2025
JULIANA PAIVA SOUZA SILVA,07/10/2025
VITORIA REGINA DA ROSA KARPSS BOEIRA,07/10/2025
NELSON LIMANA,07/28/2025
MARIA DE LOURDES MARTINS EVANGELISTA,07/10/2025
RAIANE PEREIRA HANEL,07/10/2025
BRUNO PHILIPPSEN LEIZER,08/10/2025
IVANILDE NESELLO,07/10/2025
MARISOL INGRID BECK,07/25/2025
MARA LUCIA FRITSCH SILVA,07/25/2025
JOCASTA GONCALVES ACOSTA,07/10/2025
ISOMAR FLAVIO GALL,07/10/2025
JONAS FROHLICH SANCHES,07/10/2025
FELIPE DE SOUSA PRATES,07/13/2025
LUAN DA SILVA LINCK,07/15/2025
GABRIELE DE OLIVEIRA DA SILVA,07/10/2025
GESSE DE QUADROS,07/10/2025
TATIANE DA SILVA OLIVEIRA,07/10/2025
TIAGO LUIS FLECK,07/10/2025
DEBORA DE FATIMA PEREIRA,07/10/2025
ALINE RUTIELE MACHADO FERNANDES,07/25/2025
DEISE CHAIANE MACHADO RODRIGUES,07/10/2025
MARIA JULIA STIEVANO BOTELHO,07/10/2025
JANDREI OLIVEIRA RAMOS,07/25/2025
MARLETE HINSCHINK,07/10/2025
NEUZA MARIA DOS SANTOS REIS,07/31/2025
CLEITON ALEXANDRE URBANSKI,07/10/2025
ADILIO GOMES DA SILVA,07/27/2025
CILIOMAR DIAS DA SILVA,07/25/2025
VALERIA PINHEIRO DECKER,07/10/2025
ZELINHO DOS SANTOS CAVALHEIRO,07/12/2025
CLAUDIA MARIA BERGOLD DA SILVA,07/10/2025
JOCEMAR CEZAR DIAS,07/10/2025
RODRIGO SCHUCK DA COSTA,07/10/2025
VANDERLEI LEMES RODRIGUES,07/10/2025
LEONIR MENDES DE SOUZA,07/10/2025
CARLOS ALEXANDRE DA SILVA,07/10/2025
DENI DA SILVA,07/10/2025
EMERSON RAMOS DA SILVA,07/10/2025
LEONIDES SARAIVA DA SILVA,07/10/2025
KEILA ELISA GEHRKE,07/12/2025
DEIVID FERREIRA DE OLIVEIRA,07/10/2025
ALEXANDRA PEREIRA BALDEZ,07/12/2025
ISAURA DA ROSA,07/28/2025
WESLEI SCHUCK DA SILVA,07/25/2025
OTAVIO DA SILVA BUENO,07/10/2025
MAICON JUNIOR BINELO SCHUCH,07/10/2025
FLAVIA CRISTINA SCHONARDIE,07/10/2025
NEUSA VERISSIMO RIBEIRO,07/10/2025
RAVEL REBELATTO,07/10/2025
DJULIANO NUNES DA SILVA,07/10/2025
DOUGLAS GUILHERME DOS SANTOS,07/10/2025
REGINALDO MATEUS DA SILVA,07/5/2025
TIAGO LANZER ELOI,07/10/2025
GELSON BINELOS BROCCO,07/25/2025
JONAS ISMAEL KLEIN,07/10/2025
MARLI LUIZA BIEDERMANN,07/10/2025
GILBERTO NASALIO BRUNNER,07/10/2025
LOCIMAR LEANDRO SCHMIDT,07/10/2025
DANIELA LAUERMANN,07/13/2025
CHRISTIAN RESENDE RODRIGUES,07/10/2025
DANIELA LAUERMANN,07/16/2025
EZEQUIEL MACHADO RAMOS,07/10/2025
DOUGLAS FRIZON,07/10/2025
LUIZ CARLOS SANINI,07/10/2025
LUIZ CARLOS SANINI,07/10/2025
DORACI ALVES MACHADO,07/10/2025
CRISTIANO GONCALVES,07/10/2025
CAMILA FERNANDA MATTOS DE MELLO,07/10/2025
JEFERSON ROGERIO DE MAGALHAES FERREIRA,07/10/2025
LUCIANO ALVES DA SILVA,07/10/2025
AMANDA CAROLINA DA COSTA,07/10/2025
BRUNO FELIPE GUNTZEL,08/10/2025
BRUNO FELIPE GUNTZEL,07/10/2025
FRANCISCO LUDGERO SPARREMBERGER,07/10/2025
RAFAELA BERNARDES DA CONCEICAO,07/10/2025
ELIANDRO PORTES,07/15/2025
SNH FABRICACAO DE ESTRUTURAS METALICAS LTDA,07/10/2025
GUILHERME ACHSSLER DA SILVA,07/10/2025
FERNANDO HENRIQUE DIEHL,07/10/2025
EVERSON VERONI SCHMITT,07/10/2025
JONATAN WILLIAM DE LORENA DA SILVA,07/10/2025
ILVA VIANA DE VARGAS,07/25/2025
RODRIGO ANDRIOLA,07/10/2025
ODAIR QUEIROZ,07/10/2025
JESSICA OTERO DE QUADROS,07/10/2025
MISAEL DOS SANTOS,07/10/2025
ARNALDO CORONETTI JUNIOR,07/10/2025
BRUNO GABRIEL CABRERA CAMARGO,07/5/2025
JOSEMAR DA COSTA OUTEIRO,07/25/2025
VAGNER SAMUEL MASSAIA,07/10/2025
CHARLES ANTONIO FOSCHIERA 03560690013,07/10/2025
IGOR COSTA BENKENSTEIN,08/25/2025
RENI ALVES DOS SANTOS,07/25/2025
MARIA GISELE DA SILVA DE SOUZA,07/28/2025
ROBSON DO NASCIMENTO LOPES,07/25/2025
GELSON ANTONIO KERBER,07/10/2025
ROBSON DE VARGAS DIAS,07/25/2025
JAISON VINGERT,07/10/2025
IDA WILSKE,07/20/2025
RAFAEL ZENARO,07/20/2025
RAFAEL ZENARO,06/20/2025
BRENDA GABRIELE CASSEL,07/10/2025
MAURO FLORES BRUSQUE,07/25/2025
RAQUEL DE VARGAS FIDELIS,07/10/2025
LIDIANE VERNEQUE DE ANDRADE,07/20/2025
AMANDA GABRIELE ALVES,07/20/2025
CHEILA CRISTINA BRANDAO ALEXANDRE,07/25/2025
SUZETE CRISTINA DA SILVA,07/25/2025
CAROLINA ALEXSANDRA RODRIGUES,06/25/2025
CAUANA DA SILVA,07/20/2025
ANDERSON RODRIGO DE MELO,06/25/2025
SELITO VON BORSTEL,07/15/2025
CATIANE ALMEIDA DA SILVA,07/20/2025
WALDEMAR DIAS,07/10/2025
EVANDRO RICARDO DA SILVA,07/22/2025
MILENA TOME FRANZEN,07/10/2025
EDUARDO GUILHERME KLAUS SILVA,07/2/2025
MICHELE DA SILVA LUZ,07/15/2025
OLIVIA FERNANDA SILVA DA LUZ RIBEIRO,07/25/2025
PABLO SANTOS DA SILVA,06/28/2025
DIEGO ARAMIS PRASS,07/25/2025
CARINA FABIANA DIAS,07/28/2025
ERIDETE TERESINHA MOLLER,07/15/2025
NAIR DA SILVA DAPPER,07/10/2025
ELEMAR MALMANN,08/5/2025
LIVIA PAULA DE ALMEIDA,07/25/2025
LEONARDO DOS SANTOS,07/26/2025
LAZARO MARIA DA SILVA,07/15/2025
NATALLY FERNANDES BARBOSA,07/10/2025
LUCAS DIONEI PARANHOS NUNES,06/20/2025
MICHELE VIEIRA DAS NEVES,07/25/2025
JANDIR ALVES CAVALHEIRO,07/25/2025
THAILON WILLIAM DA ROSA BARBOSA,07/8/2025
SEBASTIAN CORREIA PLACIDO,06/28/2025
LUCAS DIONEI PARANHOS NUNES,07/20/2025
CLAUDIANE DOS SANTOS SILVA,07/20/2025
VINICIUS RAFAEL GOMES,07/10/2025
WALDEMAR ROTHMANN JUNIOR,07/15/2025
FERNANDO LUIS BAGATINI,07/23/2025
LUANA MELO COUTO,07/26/2025
SAMARA BEATRIZ DE MELO,07/10/2025
CLAITON RAFAEL KIELING,07/25/2025
HEDI HOFFMANN,07/10/2025
DEISE GRAZIELA AMERICO HUTHER,07/11/2025
DEISE GRAZIELA AMERICO HUTHER,07/10/2025
CARLOS DE SOUZA BRITZKE,07/25/2025
ELOIR REMI BLUMM,07/28/2025
ANGELO RAFAEL SWAIZER,07/25/2025
LUANE SOUZA DUARTE,07/10/2025
MARTA MARIANE SIMON,07/25/2025
MARCOS SILVA DE AMORIM,07/25/2025
JESSICA EMANOELLE MACHADO VELASQUES,07/20/2025
LIONI DE FRAGA NEVES,07/10/2025
PAULA BEATRIZ TORMES,06/28/2025
KELLY LUISA DE LARA,07/5/2025
VITORIA SAMPAIO RODRIGUES,06/28/2025
JOAO MELLO,07/25/2025
ROSANGELA DE FATIMA MELLO VALSTRICH,07/10/2025
MICHELE DA ROSA MARTINS,07/25/2025
ROBSON JESUS DOS SANTOS DE MORAES,07/5/2025
LEONARDO DOS SANTOS MOURA,07/15/2025
ALISSON DOS SANTOS,07/10/2025
ROSA MARIA ALVES PATZER,07/26/2025
ELIANA DA ROSA VALENTIN,06/25/2025
MARCOS ANTONIO PEIXOTO DA ROSA,07/10/2025
DIRCEU DE OLIVEIRA,07/25/2025
CLAUDIA REGINA TASSO PICOLOTTO,07/10/2025
YASMIM KAROLINE BUENO DA SILVA,07/8/2025
BRUNA DIEHL DA SILVA,07/20/2025
CARLOS ALBERTO CENTENO MONTEIRO,07/25/2025
JENIFER SCHMIDT,07/10/2025
PRISCILA JUNGTHON DE SOUZA,07/5/2025
NICOLLE PEREIRA DOS SANTOS,07/20/2025
JEFERSON LUIS SARAIVA,06/28/2025
IRINEU JOSE VENTER,07/28/2025
CINTHIA OTILIA BACKES,06/28/2025
GUILHERME MARINHO ALVES DUARTE,07/28/2025
SANDRA REGINA DOS SANTOS,07/10/2025
ANDREW DE FREITAS PEREIRA,07/25/2025
NILSON GILMAR LUDWIG JUNIOR,07/25/2025
JUREMA TOMAZINI DE ABREU,07/25/2025
ANDRESSA LURDES TOMAZINI DE ABREU,07/25/2025
JOSE AUGUSTO DA SILVEIRA,07/25/2025
CLECI IEGGLI DA SILVA,07/10/2025
LARISSA MELO MORAIS PESSOA,07/25/2025
RITA DE CASSIA MARIA,06/28/2025
TIAGO RODRIGUES BITENCOURTE,07/25/2025
CAMILLY GIOVANA GOMES RODRIGUES,07/25/2025
CAMILLY GIOVANA GOMES RODRIGUES,06/25/2025
CATIANE NEVES,06/28/2025
VINICIUS DA SILVA PADILHA,07/5/2025
PATRICIA CAMARGO DOS SANTOS,06/25/2025
EVERSON DA MOTA BECKER,07/25/2025
NILSO VALDACI COSTA,07/10/2025
EDES GARCIA TORMES,07/10/2025
MARIA EDUARDA DA SILVA,06/28/2025
GABRIELA COMPAGNONI BRIDI,07/10/2025
NORBERTO DOS SANTOS DIAS,07/25/2025
TIAGO PRATES PINHEIRO,07/28/2025
ENEDIR DE OLIVEIRA,07/10/2025
ARIEL BENDER,07/26/2025
ELIEL ZWIRTES CAMPANHOLO,07/21/2025
MARCELINO MUNDINS VAZ,07/28/2025
ARIETE CRISTINA HAUBERT,06/20/2025
SHAYSTA KAUANI GAMIN,06/22/2025
LIANE BEATRIZ DE LIMA,07/15/2025
ANTONIO SARAIVA DA SILVA,07/1/2025
JULIANE MARIA COSTA,07/10/2025
LORENI DE OLIVEIRA,07/15/2025
DENISE POMIER,07/28/2025
DIEINES EDUARDA DE ALMEIDA DOS SANTOS,07/25/2025
VITOR MATEUS MOREIRA,07/10/2025
FRANCISCO FERNANDES DE FRAGA,07/25/2025
FRANCISCO FERNANDES DE FRAGA,06/25/2025
GIOVANI REUS DA SILVA,07/10/2025
GADIEL DO NASCIMENTO DE MATOS,07/5/2025
CARLOS GUILHERME DO NASCIMENTO BIRUE,06/20/2025
JESSICA LAIS RUPPENTHAL,07/25/2025
MARIA TAMIRES SANTOS DA SILVA,07/10/2025
DILCEU ESPINOSSA DAVILA,07/25/2025
MARELIZA CASTILHO DE MORAES,07/25/2025
MARCO AURELIO DOMINGUES,07/25/2025
EVA SANTOS DE ALMEIDA,06/25/2025
TAINA DAIANA LIMA DOS SANTOS,07/25/2025
ADRIANA FRAGA CARDOSO,07/25/2025
ADRIEL MINHOS DO COUTO MELLO,07/26/2025
CLAUDIOMIRO DIAS DOS SANTOS,07/5/2025
RABEL JOSUE BARCKFELD,07/15/2025
RABEL JOSUE BARCKFELD,07/15/2025
MARONES JUNIOR RODRIGUES DE ALMEIDA,07/10/2025
FERNANDO ANDRE DIAS,07/10/2025
PRICILA MOREIRA WILLMS,07/10/2025
ELIANDRO TELES,07/25/2025
VIVIANE BORGES DA SILVA,07/25/2025
JACYRA DE FATIMA LIMA,07/10/2025
TANIA MARIA DA COSTA,07/25/2025
DIAMANTINA MARQUES DA SILVA,07/20/2025
LUIZ TELES DA SILVA FILHO,07/25/2025
LUIZ TELES DA SILVA FILHO,06/25/2025
MARIA DE FATIMA LOPES,08/20/2025
BRUNA MAKELI OLIVEIRA RIBEIRO,08/25/2025
LUIS ARI DOS SANTOS PINTO VEICULOS,07/10/2025
DENISE BORCHARDT,07/10/2025
VIVIANE ARNOLD,07/27/2025
ELISEU RICARDO DOS SANTOS,07/10/2025
JONAS ANDRES DA SILVA ROSA,07/25/2025
CAETANO PRETTO DA SILVA,07/10/2025
MARCOS ANDRE SCHMITZ,07/25/2025
JOELIS FRELICH RAMOS,07/25/2025
ANA MARIA SOUZA DE FREITAS,07/26/2025
LUCIANO DE SOUZA COSTA,07/25/2025
IGOR NAITZEL HELLER,06/28/2025
MARIA TERESINHA KRAUSER DUARTE,07/10/2025
VICTOR HUGO GASPAR TEIXEIRA,07/10/2025
MAGDIEL KRAUSER DUARTE,07/10/2025
FLAVIO KREUZ,07/1/2025
MERIELE CAMILA CABREIRA CABEGNIN,07/25/2025
SALETE DANIELA KRAEMER,07/10/2025
DOUGLAS RODRIGUES PEREIRA,07/25/2025
MARCIA LUZIA DA SILVA,07/25/2025
MAURO SOARES DA SILVA,07/3/2025
MARCIA DE FATIMA CENA,06/25/2025
DANIELA DA SILVA NEVES,07/25/2025
LUIS ARI DOS SANTOS PINTO,07/10/2025
IZABEL JOSIANE LOREIRO DE MELLO,07/10/2025
BERTILO CELESTINO KUHN,07/10/2025
EDUARDO ADOLFO DA SILVA,07/10/2025
DEBORA MARQUES DA SILVA,07/10/2025
THERLLON ANDREFF RIBAS,07/25/2025
LEILA FERNANDA ELTZ PAES,08/5/2025
ELISETE DE OLIVEIRA SOARES BUENO,07/25/2025
IRINEU LOPES DA ROSA,07/10/2025
VALDEMAR GABRIEL GOMES DE OLIVEIRA,06/25/2025
DIEGO HENRIQUE DE OLIVEIRA,07/25/2025
DIEGO HENRIQUE DE OLIVEIRA,07/24/2025
GILSON RODRIGUES DOS SANTOS,07/10/2025
KAILAINE GOBBI KERBER,07/7/2025
JOELSON DA LUZ SCHMIDT,07/25/2025
MARIA GABRIELA FERRARI SANDER,07/10/2025
ANA ELISA DA SILVA BIANCHI,06/25/2025
DENIZE DAHMER MARTINS,07/25/2025
FERNANDO LUIS DOS SANTOS,07/10/2025
LEOCLIDES DOS REIS,06/25/2025
MARA REGINA FARIAS,07/10/2025
ADEMIR SUELO,07/15/2025
MICHELE CAROLINE DOS REIS GOMES,07/10/2025
MOACIR AFONSO SIGNORI FERGUTZ,07/10/2025
GENI MOREIRA DE LIMA,07/20/2025
RODRIGO LARA,07/10/2025
DAIANE DE OLIVEIRA PEREIRA,07/25/2025
ANDRESA CRISTINA SANTOS ZWETSCH,07/25/2025
DANIEL DA SILVA,07/12/2025
IZAIAS CAVALHEIRO,06/28/2025
MARILENE PACHECO DO AMARAL,07/25/2025
SAMUEL BRAUN,06/28/2025
MARCOS REZER DO AMARAL,06/25/2025
SILMAR ANTONIO TELES,07/10/2025
ELIZETE DA COSTA MACHADO,07/10/2025
SUZETE FONSECA DA CRUZ,07/5/2025
ELISA GAY IRASSOQUE,07/25/2025
MARCOS AURELIO DIOGO,07/1/2025
ELIAS MARQUES ANTUNES,06/26/2025
MARCIO MATIAS,07/10/2025
JOSE DE LEMOS COSTA,06/25/2025
BRUNA STEFANI AMARAL BENDER,07/15/2025
ANTONIA DOS SANTOS JESUS,07/20/2025
JEFERSON ANTUNES,07/10/2025
ANDERSON PIRES DA ROCHA,07/25/2025
EDUARDA ISABELLA ROSTIROLLA,07/1/2025
LOIVO NUNES DE BARROS,07/20/2025
EZEQUIEL DE SOUZA PINHEIRO,07/7/2025
KATIELE DA SILVA FEDERIGO,06/20/2025
ALINE STRECKERT,06/28/2025
KELVINY LEAL TRINDADE,07/25/2025
VALDERIS MAIER DE OLIVEIRA,07/5/2025
LEANDRO DE SOUZA FRAGA,07/25/2025
ROGER JUNG,07/5/2025
VLADIMIR FLORES DOS SANTOS,06/21/2025
TIAGO VIEIRA DAS NEVES,07/10/2025
FELIPE GONCALVES DIAS DA SILVA,07/8/2025
JULIANO SABKA,07/5/2025
STEFANI SOARES MADEIRA,07/25/2025
PATRICIA ROSANA CASSEL,08/7/2025
SOPHIA MILENA ZIMMER WALLAUER,07/10/2025
AGUIAR ALMEIDA BICA,06/25/2025
DOUGLAS EDUARDO GOMES DAMACENA,07/10/2025
TANIA MARLI KAUER,07/5/2025
MARLISE MADEIRA,06/28/2025
HELEN DAIANE FETTER,07/20/2025
MAICON RODRIGO DE VARGAS,06/28/2025
MARCIO RODRIGO ALTENHOFEN,07/27/2025
ANTONIO JOSE DOS SANTOS NETO,07/10/2025
VANESSA MARIA DA SILVA,07/25/2025
KEILA SANTOS DA SILVA,07/20/2025
KEILA SANTOS DA SILVA,07/25/2025
DAIANE DE AZEREDO VARGAS,07/10/2025
REGIS ADRIANI CONCEICAO CARDOSO ,07/28/2025
DOUGLAS HENRIQUE HAACK,07/7/2025
TAMARA CASSIANA CRUZ,07/5/2025
EDSON ADEMIR RITTER,07/25/2025
FELIPE OLIVEIRA DOS SANTOS,07/10/2025
ROBSON DA SILVA VARGAS,06/28/2025
ADRIANA DA SILVA,07/25/2025
WESLEY PEDROSO DA SILVA,06/25/2025
ODAIR SALES PRESTES,06/25/2025
JOSEANE KASSNER,07/25/2025
JUNIOR MOURA DE JESUS,07/20/2025
LUIZ DANIEL SCHMITT,07/20/2025
CARINA SCALCON,07/5/2025
JAQUELINE MARIA BARTNIK,07/20/2025
ELSON DA CRUZ MOREIRA,06/20/2025
MARCO ANTONIO LUCIANO,07/5/2025
ANA PAULA MEDEIROS BRANDAO,07/25/2025
VALDENIR JOSE DUARTE,07/10/2025
IZAURA MARIA MACIEL,06/28/2025
JULIANA SABRINA DOS SANTOS,06/25/2025
ESTELA MARA DA SILVA E SILVA ESTULANO,07/22/2025
SABRINA FROHLICH,06/25/2025
ANGELA MARIA ALVES CIDADE,08/1/2025
BRAIAN VALENTIN SERAFINI,07/10/2025
ALFREDO JUNIOR GOMES,07/8/2025
CRISTIANO SCRINZ,08/1/2025
BERNARDO RENATO MALHEIROS DA SILVA,07/15/2025
DOUGLAS DO NASCIMENTO GONCALVES,07/10/2025
LEDA ANTONIA NEVES SILVEIRA,06/20/2025
MORJANA BRITO,07/25/2025
DANRLEI HILBERT DE SOUZA 04525539038,06/25/2025
GIOMAR JOHANN KLEIN,06/25/2025
PATRICIA TRESPACH DA SILVA,07/10/2025
VANTUIR NUNES DOS SANTOS,06/20/2025
ANDRIELI AVILA DE SOUZA,07/25/2025
EDSON OTTO,08/5/2025
EDSON OTTO,07/5/2025
RUDINEI REIS,07/10/2025
CARLOS ROBERTO NUNES VIEIRA,06/25/2025
EBERTON ALVES FERREIRA,07/5/2025
ADRIANO HAXY PEREIRA DA COSTA,07/28/2025
VALNEI DE OLIVEIRA ANTUNES,06/27/2025
CAMILA LIMA DE SOUZA,06/28/2025
JONATAS DAVI DOS SANTOS,06/25/2025
GISLEINE KARLA DA COSTA,07/27/2025
FLAVIO ROBERTO BOHRER,07/25/2025
MICHELI JOVANA WAGNER RECHENMACHER,07/25/2025
LUCIANE BORN,06/28/2025
ALEXANDRE ENGELMANN DOS SANTOS,06/26/2025
JOELMA BENDER BAMPI,06/28/2025
KELLY APARECIDA MOREIRA DA SILVA,07/5/2025
PRISCILA VIEIRA LASTA,07/5/2025
MARIA LORENA BONACHESKI WOLFF,07/10/2025
ADRIANO ANTONIO KAUTZMANN,06/27/2025
FABIANO BAZZOTTI,06/20/2025
SUCATAO DO ROGERIO EIRELI - ME,07/10/2025
JULIO SCHENATO FONINI CONSULTORIA EMPRESARIAL,07/5/2025
ALESSANDRO PEREIRA SANTIAGO,06/10/2025
LUCAS FRANCISCO DA SILVA,07/5/2025
ARQUIMEDES PEDRO PIOVEZAN 38528126900,06/25/2025
SERGIO LUIZ TIMM,07/10/2025
FELIPE DOS SANTOS VARGAS,07/25/2025
ANGELA CRISTINA MARTINS FERREIRA,06/25/2025
MILENA NUNES DOS SANTOS,07/20/2025
MILENA NUNES DOS SANTOS,06/20/2025
VAGNER RODRIGUES DA SILVA,06/25/2025
ANGELINA DOS SANTOS,07/5/2025
FRANCIELE DOS REIS BARBOSA,06/28/2025
CAROLINE DE AVILA DE BASTOS,07/6/2025
ANDERSON SANTOS AZEREDO,07/15/2025
KAUANA DAVILA MATOS,07/10/2025
RAIANE ALESSANDRA DA SILVA,07/22/2025
ELENA DA SILVA,07/6/2025
FELIPE DANTAS LIMA,06/25/2025
MARISETE DOMINGUES MACHADO,07/25/2025
VALMIR GOMES DA SILVA,07/25/2025
ANTONIO CLAUDIOMIRO DA SILVA,07/10/2025
JANINE APARECIDA HENKEL,07/28/2025
JANINE APARECIDA HENKEL,06/28/2025
ERICK MICAEL DE JESUS OLIVEIRA,08/10/2025
MARIA JOCELI CAMARGO,07/10/2025
BRUNO LEAL DIAS,07/25/2025
TAIKER ADRIEL ROSA MELLO,07/22/2025
JEFERSON DE SOUZA DA SILVA,06/28/2025
ADROALDO MARIA DA SILVA,07/28/2025
DOUGLAS RAFAEL FELIX,07/25/2025
NELCI ANACLETO NERICKE,07/20/2025
JACSON DA SILVA DE OLIVEIRA,07/10/2025
LUCAS SANTOS DE SOUZA,07/10/2025
LUIZ CASTRO DE LIMA,07/10/2025
JOCELI DE FATIMA DE MENEZES PIMENTEL,07/3/2025
MARLI FRIDA DA SILVA MACHADO,07/10/2025
GABRIEL FERNANDES DOS PASSOS,06/25/2025
ELISANDRA BRITZKE BOTTEGA,07/14/2025
MOISES RODRIGO COIMBRA SCHMITT,07/20/2025
GABRIEL GRAMINHO DA SILVA,07/15/2025
GABRIEL RODRIGO SCHARLAU,07/20/2025
VALDENIR DUCAS ALVAREZ,07/20/2025
ARNO JULIANO MACHADO GOTTSCHOLK,07/10/2025
RALF AIRES VAN OUDHEUSDEN,07/5/2025
DIENIFER HAAG DE ABREU,06/28/2025
ELOI ALBINO MALLMANN,07/25/2025
ANDERSON SONAGLIO,08/10/2025
ANDERSON LUTERO BENDER,06/28/2025
FRANCIELI MONTEIRO JORIX,07/20/2025
58.897.187 ROMULO IAGO DA ROSA,07/15/2025
ALVONI NISSOLA DA SILVEIRA,07/25/2025
MARIA NELDI ELTZ,07/25/2025
LUCAS ELISANDRO FLECK,07/25/2025
ARI DE OLIVEIRA,07/5/2025
ALEXANDRO DA SILVA,07/25/2025
JAIR DE FRAGA LUZ,07/25/2025
GEOVANE SILVEIRA DE OLIVEIRA,07/10/2025
FELIPE AMADOR DOS REIS,07/10/2025
LUAN ROOS DE SOUZA,07/6/2025
IVETE TEREZINHA KOLLING LIMBERGER,07/5/2025
MONAYSA DA SILVA MELO,07/25/2025
PAULO CESAR VISINESKI,06/20/2025
FABIANO MULLER,07/25/2025
DIOGO JUNIOR DA SILVA,07/10/2025
LETICIA FELTES,07/20/2025
LUIS AUGUSTO FERNANDES DIAS,07/22/2025
MARCELO REDEL,07/15/2025
RITIELE HOPPE KARNOPP,07/25/2025
JULIA LUZ BOHRER,07/25/2025
MELANIA MARIA LAZARIN,07/28/2025
ANA CAROLINA DE OLIVEIRA,07/15/2025
NATASKA DE SOUZA OSTJEN,07/21/2025
VALDACI ADELAR HAAG,07/25/2025
JONAS LEANDRO FAGUNDES WESCHENFELDER,07/15/2025
GUILHERME MACHADO MOTTA,07/15/2025
SARA SEVERO CAMPOS,07/10/2025
SADI MACHADO,07/10/2025
55.799.635 DEOCLECIO JACOB EILERT DAMACENA,06/25/2025
KELVIN DOS SANTOS WAGNER,07/10/2025
PAULO SOARES DE OLIVEIRA,07/25/2025
JOSE ELIAS TIMM,08/10/2025
VALDEMAR DRUMM,07/25/2025
SIDNEI VIANNA,07/10/2025
SONIA MARA VIANA,07/20/2025
ALESSANDRO PEREIRA SANTIAGO,07/10/2025
GABRIEL LUIS DA SILVA,07/20/2025
GISELE FREITAS DE ANDRADE,07/10/2025
JADIR DOS SANTOS GOMES,07/10/2025
MACIEL DE OLIVEIRA DINIZ,07/22/2025
GREICE DIANA BLUMM,07/25/2025
THAMIRES PEREIRA DA SILVA BITENCOURTE,07/25/2025
BIANCA MORAES FINOTTI,07/22/2025
DIONATA POSPICHIL IARONKA,07/10/2025
RAMBO SEGURANÇA PRIVADA,07/20/2025
OELIABE ZANCHETTA DE OLIVEIRA,07/10/2025
DAIANE DA SILVA,07/10/2025
EVERTON DA SILVA ACORDI,07/25/2025
PEDRO HENRIQUE SCHERER,07/10/2025
ISMAEL DA SILVA,07/10/2025
CRISTIANE DOERING REINALDO,07/10/2025
OSIEL MASSAIA,07/28/2025
EVANDRO CARLOS DA SILVA,06/22/2025
VALDECIR ANTONIO SEVERO,07/25/2025
JESSICA BATISTI,07/22/2025
SANTIAGO MOTA,07/10/2025
RODRIGO VIEIRA SOARES,07/25/2025
QUELIN LOUISE DE SOUZA COSTA,07/11/2025
KEIDI MODINGER,07/10/2025
SIDNEI ALEXANDRE TRENTIM,07/25/2025
GEOVANI ROCHA PEDEZERT,08/10/2025
GEOVANI ROCHA PEDEZERT,07/10/2025
RAMON LUIS HUFF LASCH,07/23/2025
MARCIA RICARDO SILVA,07/25/2025
JONAS MATEUS LEWRENZ KUHS,07/18/2025
MAYARA GABRIELE DE OLIVEIRA MACHADO,06/28/2025
JOICE DIAS DA SILVA,07/10/2025
ADRIANA SCOLARI CORREA DA SILVA,07/24/2025
DOUGLAS WILLIAM K. DE ALMEIDA,07/20/2025
JOSIANE DA CRUZ DE OLIVEIRA,07/15/2025
CLEUZA REJANE MOLINA ZUNDLER,07/10/2025
CAROLINA ROSA DA SILVEIRA,07/28/2025
CLEBER DA SILVA ROLDAO,08/10/2025
JOSE DARI OLIVEIRA SOARES,07/25/2025
WESLEI DE VARGAS OLIVEIRA,07/25/2025
WESLEI DE VARGAS OLIVEIRA,07/25/2025
CARLA ANDRIELI DA SILVA LIMBERGER,07/22/2025
ADELCIO WALDEMAR WILBERT,07/22/2025
CATIELE SCHUVARZ DE CASTRO,07/28/2025
QUELIN LOUISE DE SOUZA COSTA,07/10/2025
VALDEMIR ALVES,07/10/2025
ROSELEI WIRGANOVICZ,07/25/2025
LUCAS DE AGUIAR SCHWINGEL,07/28/2025
PRYSCILLA NUNES,07/10/2025
MARLEI GONCALVES DOS SANTOS,07/10/2025
CARLEI HENRIQUE BAUM,07/10/2025
SAMIR ANDRE RODRIGUES DE FREITAS,07/10/2025
TANIA MARA AIRES BATALHA,07/15/2025
ALAIDES MASSAIA,07/10/2025
ROBERTO AUGUSTO KUNST,07/15/2025
GIOVANA LUGINSKI GOMES,07/10/2025
VANDERLEI PINTO ALVES,07/10/2025
ARIANE LUCIANE SCHIRMER,07/20/2025
SERVISUL SERVIÇOS MULTIPLOS LTDA- ME,07/20/2025
DIONICE NOEMI DAMACENO MELO,07/25/2025
LEOMARA TERESINHA WANNER,07/8/2025
FERNANDO DE SOUZA ALMEIDA,07/10/2025
MARCOS ANTONIO DE ALMEIDA,07/20/2025
JANAINA BRAZ RANGEL,07/15/2025
BIANCA FRANCIELE DE ALMEIDA MACHADO,07/1/2025
JORGE LUIS ALVES VIEIRA,06/20/2025
EZEQUIEL CAVALHEIRO DE OLIVEIRA,07/27/2025
ARIEL SIGNORINI DE SOUZA,07/20/2025
CARMEN SILVA E SILVA,07/15/2025
GERONIMO GELINGER,07/20/2025
MARIA ZELI ALMEIDA DE SOUZA ADAM,07/10/2025
EMERSON RODRIGUES AFONSO,07/10/2025
NATANAEL DOS SANTOS,07/10/2025
ALEXANDRE SCHEFFER,07/10/2025
ILTON HOFFMANN,07/10/2025
JAIR RODRIGUES CAVALHEIRO JUNIOR,07/10/2025
JOSIANE DOS PASSOS NUNES,07/20/2025
ADELAIDE TEREZINHA BOEIRA,07/6/2025
TAMIRES DA SILVA,07/25/2025
MARISA GRILEITOW,07/10/2025
EDINA FERREIRA DA SILVA,07/20/2025
CARLA DA SILVA,07/5/2025
CRISTIANE SCHMITT,07/25/2025
JAIANE SILVA DEUS,07/15/2025
GABRIEL WOLFF DA COSTA,07/23/2025
FABIO LUIS NEVES,07/10/2025
VANDERLEI WOLK,08/20/2025
SAMUEL ADRIANO RODRIGUES,07/25/2025
MARCIANO DA SILVA,07/25/2025
ELIANE DIONEIA VEDOVATTO,07/15/2025
DIONES GUSTAVO DA ROSA,07/10/2025
ISABEL DUARTE RIBAS PEREIRA,07/20/2025
LAURI MASS,06/25/2025
SIMONE PEREIRA,07/20/2025
KELLY RAFAELA E SILVA DA SILVA,07/10/2025
FABRICIO AUGUSTO KERSCHNER,07/25/2025
FERNANDA CAROLINE DIAS FARIAS,07/10/2025
ANA PAULA DA COSTA MARTINS,07/21/2025
GUSTAVO CESAR DA SILVA KIELING,07/10/2025
JONAS ANTONIO GALIAZZI,07/25/2025
JOAO CARLOS FERREIRA JUNIOR,06/28/2025
CLECI GONCALVES LEAL,07/23/2025
LUCIANO RAMOS DA SILVA,07/25/2025
CRISTIANO DOS SANTOS LEMOS,07/21/2025
DIENIFER DA SILVA LEHMANN NUNES,07/20/2025
ALICE FONINI LOTH,07/20/2025
RONEI DOS SANTOS,07/10/2025
VELCI BRAZ SESSIM,07/25/2025`.trim();

// Transforma em array de pares [nome, data]
const registros = entrada.split("\n").map(linha => {
  const partes = linha.split(",");
  const nome = partes[0].replace(/'/g, "''").trim();
  const [mes, dia, ano] = partes[1].trim().split("/");
  const data = `${ano}-${mes}-${dia.length < 2 ? "0" + dia : dia}`;
  return [nome, data];
});

// Divide em blocos de 50
const dividirBlocos = (array, tamanho) => {
  const blocos = [];
  for (let i = 0; i < array.length; i += tamanho) {
    blocos.push(array.slice(i, i + tamanho));
  }
  return blocos;
};

const gerarQuery = bloco => {
  const valuesSQL = bloco
    .map(([nome, data]) => `('${nome}', '${data}')`)
    .join(",\n        ");
  return `
WITH entradas (nome_razaosocial, data_vencimento) AS (
    VALUES 
        ${valuesSQL}
),
pessoas_encontradas AS (
    SELECT 
        e.nome_razaosocial,
        e.data_vencimento,
        p.codpessoa
    FROM entradas e
    LEFT JOIN mk_pessoas p 
        ON p.nome_razaosocial = e.nome_razaosocial
),
faturas_combinadas AS (
    SELECT 
        pe.nome_razaosocial,
        pe.data_vencimento,
        pe.codpessoa,
        f.codfatura
    FROM pessoas_encontradas pe
    LEFT JOIN mk_faturas f 
        ON f.cd_pessoa = pe.codpessoa 
        AND f.data_vencimento = pe.data_vencimento
        AND f.excluida = 'N'
),
resultado_final AS (
    SELECT
        nome_razaosocial,
        data_vencimento,
        COUNT(DISTINCT codpessoa) AS total_pessoas,
        COUNT(*) FILTER (WHERE codfatura IS NOT NULL) AS total_faturas,
        COUNT(DISTINCT codpessoa) FILTER (WHERE codfatura IS NOT NULL) AS pessoas_com_fatura,
        MIN(codfatura) AS codfatura_real
    FROM faturas_combinadas
    GROUP BY nome_razaosocial, data_vencimento
)
SELECT
    CASE 
        WHEN total_faturas > 1 AND pessoas_com_fatura > 1 THEN 3
        WHEN total_pessoas > 1 AND total_faturas = 0 THEN 0
        WHEN total_faturas > 1 THEN 1
        ELSE COALESCE(codfatura_real, -1)
    END AS codfatura,
    nome_razaosocial AS nome,
    data_vencimento AS data
FROM resultado_final;`;
};

(async () => {
  try {
    const blocos = dividirBlocos(registros, 50);
    const resultados = [];

    for (let i = 0; i < blocos.length; i++) {
      console.log(`🔍 Executando bloco ${i + 1}/${blocos.length}...`);
      const query = gerarQuery(blocos[i]);
      const resultadoBloco = await knex.raw(query);
      resultados.push(...resultadoBloco.rows);
    }

    console.log("\n✅ Resultados finais:");
    console.table(resultados);

    const cabecalho = "codfatura,nome,data";
    const linhas = resultados.map(r => `${r.codfatura},"${r.nome}",${r.data}`);
    const conteudoCSV = [cabecalho, ...linhas].join("\n");

    // 💾 Salvando no arquivo
    fs.writeFileSync("resultadosNovo2.csv", conteudoCSV, "utf8");
    console.log("📁 Arquivo 'resultados.csv' salvo com sucesso!");
  } catch (error) {
    console.error("❌ Erro ao executar consultas:", error.message);
  } finally {
    await knex.destroy();
  }
})();
